# üîê Chahua License System - ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏•‡∏¥‡∏Ç‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏£‡∏ö‡∏Ñ‡∏£‡∏±‡∏ô

‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ license key ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô Electron ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏™‡∏π‡∏á‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢

## üåü ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏û‡∏¥‡πÄ‡∏®‡∏©

- ‚úÖ **‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á**: ‡∏Å‡πá‡∏≠‡∏õ‡∏°‡∏≤‡∏à‡∏≤‡∏Å `license-guard.js` ‡πÅ‡∏•‡∏∞ `license-generator.js` ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á‡πÅ‡∏•‡πâ‡∏ß
- üõ°Ô∏è **‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö UNBOUND License**: ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö development ‡πÅ‡∏•‡∏∞ testing  
- üîí **Machine Fingerprint Binding**: ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ license ‡∏´‡∏•‡∏≤‡∏¢‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á
- ‚ö° **Caching System**: ‡πÅ‡∏Ñ‡∏ä 30 ‡∏ô‡∏≤‡∏ó‡∏µ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
- üìÅ **Auto Path Detection**: ‡∏≠‡πà‡∏≤‡∏ô license ‡∏à‡∏≤‡∏Å `tools/license.key` ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
- üèóÔ∏è **Production Ready**: ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á development ‡πÅ‡∏•‡∏∞ production (packaged app)

## üì¶ ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á

### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1: Copy ‡∏ó‡∏±‡πâ‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå
```bash
# Copy ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå chahua-license-system ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡πÉ‡∏´‡∏°‡πà
cp -r chahua-license-system /path/to/new-project/
```

### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2: Git Submodule
```bash
git submodule add https://github.com/chahuadev/chahua-license-system.git
```

## üöÄ ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

### ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏¥‡∏° (Legacy Mode)
```javascript
// ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ license-guard.js ‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏£
const { ensureLicensed, installLicenseFromContent, getLicensePath } = require('./chahua-license-system/legacy');

// ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö license
try {
    const result = await ensureLicensed();
    console.log('‚úÖ License OK:', result.status);
    console.log('‡πÄ‡∏´‡∏•‡∏∑‡∏≠:', result.daysRemaining, '‡∏ß‡∏±‡∏ô');
    console.log('Plugin:', result.pluginId);
} catch (error) {
    console.error('‚ùå License Error:', error.message);
}
```

### ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô License Widget (UI)
```html
<!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô HTML -->
<script src="chahua-license-system/ui/license-widget.js"></script>

<!-- Auto-init Widget -->
<div data-chahua-license
     data-project-name="‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì"
     data-project-url="/dashboard"
     data-api-endpoint="/api/license/check"
     data-position="bottom-right"
     data-theme="dark"></div>
```

### ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà (Modern API)
```javascript
const { LicenseManager, LicenseGenerator, LicenseValidator } = require('./chahua-license-system');

// ‡∏™‡∏£‡πâ‡∏≤‡∏á License Manager
const licenseManager = new LicenseManager({
    appId: 'com.company.myapp'
});

// ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö license
const result = await licenseManager.ensureLicensed();
```

## Features ‚ú®

- **üõ°Ô∏è Military-Grade Security**: AES-256-GCM encryption with PBKDF2 key derivation
- **üñ•Ô∏è Machine Binding**: Hardware fingerprint binding for license protection
- **‚è∞ Flexible Duration**: Support for custom license durations (30/60/90/120 days)
- **üîì UNBOUND Licenses**: Development licenses without machine binding
- **üéØ Multi-App Support**: Use across multiple Electron applications
- **üíº Customer Management**: Customer-specific license generation
- **üöÄ Easy Integration**: Simple API for Electron apps

## Installation üì¶

```bash
npm install chahua-license-system
```

Or copy the entire `chahua-license-system` folder to your project.

## Quick Start üöÄ

### Basic Usage

```javascript
const { LicenseManager } = require('chahua-license-system');

// Initialize license manager
const licenseManager = new LicenseManager({
    appId: 'my-electron-app',
    toolsDir: './tools' // Optional: custom tools directory
});

// Check if app is licensed
try {
    await licenseManager.ensureLicensed();
    console.log('‚úÖ Application is licensed!');
} catch (error) {
    console.error('‚ùå License error:', error.message);
}
```

### Generate Licenses

```javascript
const { LicenseGenerator } = require('chahua-license-system');

// Generate UNBOUND license (for development)
const devLicense = LicenseGenerator.createUnboundLicense(90); // 90 days

// Generate customer license
const customerLicense = LicenseGenerator.createCustomerLicense(
    'ABC Company',
    30, // 30 days
    ['DATABASE', 'EXPORT', 'API'] // features
);

// Save license to file
LicenseGenerator.saveLicense(devLicense, './license.key');
```

### Validate Licenses

```javascript
const { LicenseValidator } = require('chahua-license-system');

// Validate license content
const validation = LicenseValidator.validateLicense(licenseContent);

if (validation.valid) {
    console.log(`License valid for ${validation.remainingDays} days`);
    console.log(`Status: ${validation.status}`);
} else {
    console.log(`Invalid license: ${validation.message}`);
}
```

## API Reference üìö

### LicenseManager

Main class for license management in your application.

```javascript
const manager = new LicenseManager(options)
```

**Options:**
- `appId`: Application identifier
- `toolsDir`: Tools directory path (optional)
- `cacheTimeout`: Cache timeout in milliseconds (default: 30 minutes)

**Methods:**
- `ensureLicensed()`: Ensure application is licensed (throws if not)
- `validateCurrentLicense()`: Validate current license file
- `installLicense(content)`: Install license from content
- `getLicenseStatus()`: Get current license status
- `isLicensed()`: Check if application is licensed (boolean)

### LicenseGenerator

Generate encrypted license keys.

**Static Methods:**
- `createUnboundLicense(days)`: Create UNBOUND license
- `createCustomerLicense(name, days, features)`: Create customer license  
- `getMachineFingerprint()`: Get current machine fingerprint
- `saveLicense(content, filepath)`: Save license to file
- `loadLicense(filepath)`: Load license from file

### LicenseValidator

Validate and verify license keys.

**Static Methods:**
- `validateLicense(content)`: Validate license content
- `validateLicenseFile(filepath)`: Validate license file
- `getLicenseInfo(content)`: Get detailed license information

## Command Line Tools üõ†Ô∏è

### Generate License

```bash
# Generate UNBOUND license
node scripts/generate-license.js --type unbound --days 90

# Generate customer license  
node scripts/generate-license.js --type customer --customer "ABC Corp" --days 30

# Save to file
node scripts/generate-license.js --output license.key
```

### Validate License

```bash
# Validate license file
node scripts/validate-license.js license.key

# Show detailed information
node scripts/validate-license.js --info license.key

# Validate license content
node scripts/validate-license.js --content "eyJhbGciOiJI..."
```

## Integration Guide üîß

### 1. Add to Electron Main Process

```javascript
const { LicenseManager } = require('chahua-license-system');

const licenseManager = new LicenseManager({
    appId: 'com.company.myapp'
});

app.whenReady(async () => {
    try {
        await licenseManager.ensureLicensed();
        createWindow(); // License OK, create app window
    } catch (error) {
        // Show license dialog or exit
        dialog.showErrorBox('License Error', error.message);
        app.quit();
    }
});
```

### 2. Add to Preload Script

```javascript
const { contextBridge, ipcRenderer } = require('electron');

contextBridge.exposeInMainWorld('license', {
    getStatus: () => ipcRenderer.invoke('license:getStatus'),
    install: (content) => ipcRenderer.invoke('license:install', content)
});
```

### 3. Add IPC Handlers

```javascript
const { ipcMain } = require('electron');

ipcMain.handle('license:getStatus', async () => {
    return licenseManager.getLicenseStatus();
});

ipcMain.handle('license:install', async (event, content) => {
    return licenseManager.installLicense(content);
});
```

## License Types üìã

### UNBOUND License
- No machine binding
- Perfect for development
- Can be used on any machine
- Typically longer duration (90+ days)

### CUSTOMER License  
- Bound to specific machine
- Production use
- Customer-specific information
- Shorter duration (30-60 days)

## Security Features üîí

- **AES-256-GCM Encryption**: Military-grade encryption
- **Machine Fingerprinting**: Hardware-based license binding
- **Secure Key Derivation**: PBKDF2 with salt
- **Tamper Detection**: Authentication tags prevent modification
- **Expiration Handling**: Automatic expiry checking

## File Structure üìÅ

```
‚îú‚îÄ‚îÄ üìÅ chahua-license-system/
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ lib/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ license-generator.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ license-guard.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ license-manager.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÑ license-validator.js
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ scripts/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ generate-license.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ quick-license.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÑ validate-license.js
‚îÇ   ‚îú‚îÄ‚îÄ üìú LICENSE
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ index.js
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ legacy.js
‚îÇ   ‚îî‚îÄ‚îÄ üìÑ package.json
‚îú‚îÄ‚îÄ üìÅ tools/
‚îÇ   ‚îî‚îÄ‚îÄ üìú license.key
‚îú‚îÄ‚îÄ üìÅ ui/
‚îÇ   ‚îú‚îÄ‚îÄ üåê demo.html
‚îÇ   ‚îú‚îÄ‚îÄ üåê example.html
‚îÇ   ‚îî‚îÄ‚îÄ üìÑ license-widget.js
‚îî‚îÄ‚îÄ üìñ README.md # This file
```

## Testing üß™

Run the test suite:

```bash
npm test
```

Or manually:

```bash
node test/test-license.js
```

## Examples üí°

### Complete Electron Integration

```javascript
// main.js
const { app, BrowserWindow, ipcMain, dialog } = require('electron');
const { LicenseManager } = require('chahua-license-system');

const licenseManager = new LicenseManager({
    appId: 'com.mycompany.myapp'
});

// Gate application startup
app.whenReady(async () => {
    try {
        const status = await licenseManager.ensureLicensed();
        console.log(`Licensed for ${status.remainingDays} more days`);
        createWindow();
    } catch (error) {
        const result = dialog.showMessageBoxSync(null, {
            type: 'error',
            title: 'License Required',
            message: error.message,
            buttons: ['Install License', 'Exit']
        });
        
        if (result === 0) {
            // Show license installation dialog
            showLicenseDialog();
        } else {
            app.quit();
        }
    }
});

// IPC handlers
ipcMain.handle('license:getStatus', async () => {
    return licenseManager.getLicenseStatus();
});

ipcMain.handle('license:install', async (event, licenseContent) => {
    try {
        const result = licenseManager.installLicense(licenseContent);
        return { success: true, result };
    } catch (error) {
        return { success: false, error: error.message };
    }
});
```

## License Widget UI üé®

The License Widget provides a floating visual indicator for web-based projects showing real-time license status.

### Features
- **Real-time Status**: Shows license validity and remaining days
- **Floating Display**: Non-intrusive corner positioning
- **Theme Support**: Light and dark themes
- **Auto-init**: Automatic initialization via data attributes
- **Responsive Design**: Works on mobile and desktop

### Quick Setup

```html
<!-- Include the widget -->
<script src="chahua-license-system/ui/license-widget.js"></script>

<!-- Auto-initialize with data attributes -->
<div data-license-widget 
     data-api-url="/api/license/check"
     data-theme="dark"
     data-position="bottom-right"></div>
```

### API Endpoint Required

The widget expects a license status endpoint:

```javascript
// Express.js example
app.get('/api/license/check', async (req, res) => {
    try {
        const licenseManager = new LicenseManager({
            appId: 'com.mycompany.webapp'
        });
        const status = await licenseManager.getLicenseStatus();
        res.json(status);
    } catch (error) {
        res.status(400).json({ error: error.message });
    }
});
```

### Manual Initialization

```javascript
const widget = new ChahuaLicenseWidget({
    apiUrl: '/api/license/check',
    theme: 'dark',
    position: 'bottom-right',
    refreshInterval: 30000
});
```

### Configuration Options

| Option | Default | Description |
|--------|---------|-------------|
| `apiUrl` | `/api/license/check` | License status API endpoint |
| `theme` | `dark` | Widget theme (`light`/`dark`) |
| `position` | `bottom-right` | Corner position |
| `refreshInterval` | `30000` | Status refresh interval (ms) |

### Demo & Examples

- **Interactive Demo**: Open `ui/demo.html` in your browser
- **Usage Examples**: See `ui/example.html` for implementation patterns

## Support üí¨

- üåê Website: [https://www.chahuadev.com](https://www.chahuadev.com)
- üìß Email: dev@chahuadev.com
- üêõ Issues: [GitHub Issues](https://github.com/chahuadev/chahua-license-system/issues)

## License üìÑ

MIT License - see [LICENSE](LICENSE) file for details.

---

**Developed with ‚ù§Ô∏è by Chahua Development Thailand**
#   c h a h u a - l i c e n s e - s y s t e m 
 
 
